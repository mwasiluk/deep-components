
<link rel="import" href="../odc-d3-datalet/odc-d3-datalet.html">


<dom-module id="histogram-datalet">
    <template>
        <odc-d3-datalet id="charts" data-url="{{dataUrl}}" fields="{{fields}}" title="{{title}}" description="{{description}}" export_menu="{{export_menu}}" data="{{data}}"></odc-d3-datalet>
    </template>
    <script>

        var HistogramBehavior = {
            presentData: function () {

                var self =this;
                var conf = {
                    x:{
                        key: this.properties.selectedFields[0].value,
                        title: self._component.xAxisLabel,
                        ticks: self._component.ticks
                    },
                    y:{
                        title: self._component.yAxisLabel
                    },
                    tooltip: true,
                    frequency: self._component.frequency
                };
                conf.groups=null;
                if(this.properties.groupKey){
                    conf.groups= {
                        key: self.properties.groupKey
                    }
                }

//                console.log(conf, this.properties.data);


                var plot = new ODCD3.Histogram(this._component.$.charts.$.container, this.properties.data, conf);
            }
        };

        HistogramDatalet = Polymer({
            is: 'histogram-datalet',
            properties: {
                data: {
                    type: Array,
                    value: undefined
                },
                xAxisLabel: {
                    type: String,
                    value: ""
                },
                yAxisLabel: {
                    type: String,
                    value: ""
                },
                ticks: {
                    type: Number,
                    value: undefined
                },
                frequency: {
                    type: Boolean,
                    value: true
                },
                behavior : {
                    type : Object,
                    value : {}
                },
                /**
                 * Control the export menu
                 * xxxx BITMASK. FROM RIGHT : HTML, PNG, RTF, MY SPACE (eg. 1111 show all, 0000 hide all)
                 *
                 * @attribute export_menu
                 * @type Number
                 * @default 15
                 */
                export_menu : {
                    type  : Number,
                    value : 15 // xxxx BITMASK. FROM RIGHT : HTML, PNG, RTF, MY SPACE (eg. 1111 show all, 0000 hide all)
                }
            },

            /**
             * 'ready' callback extend the scatterchartComponentBehavior with HighchartsComponentBehavior and scatterchartBehavior
             * and run the Datalet workcycle.
             *
             * @method ready
             */
            ready: function(){
                this.behavior = $.extend(true, {}, OdcD3ComponentBehavior, HistogramBehavior);
                this.async(function(){this.behavior.init(this)},0);
            }
        });
    </script>
</dom-module>